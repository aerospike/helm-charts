# Kafka broker configuration for integration testing
# Uses Confluent Platform Helm chart (supports Kafka 4.1.0+ KRaft mode)
# To install: helm repo add confluentinc https://packages.confluent.io/helm && helm install kafka confluentinc/confluent-for-kubernetes -f kafka-values.yaml -n aerospike-test

# Confluent Platform configuration for Kafka broker
# Using Confluent's Kafka operator which supports KRaft mode
global:
  provider:
    kubernetes:
      enabled: true

# Kafka broker configuration
kafka:
  enabled: true
  replicas: 1
  
  # Use KRaft mode (no ZooKeeper required for Kafka 4.1.0+)
  # Confluent Platform supports KRaft mode
  configOverrides:
    server:
      - "process.roles=broker,controller"
      - "controller.quorum.voters=0@kafka-0.kafka.aerospike-test.svc.cluster.local:9093"
      - "listeners=PLAINTEXT://:9092,CONTROLLER://:9093"
      - "advertised.listeners=PLAINTEXT://kafka-0.kafka.aerospike-test.svc.cluster.local:9092"
      - "listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT"
      - "inter.broker.listener.name=PLAINTEXT"
      - "controller.listener.names=CONTROLLER"
      - "log.dirs=/var/lib/kafka/data"
  
  # Disable persistence for testing
  persistence:
    enabled: false

# Disable ZooKeeper (not needed for KRaft mode)
zookeeper:
  enabled: false
